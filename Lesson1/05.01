//Dis Sistemden Data Cekmek
//ornek 1: Endpoint olarak https://th-apex-http-callout.herokuapp.com/animals sitesini kullanarak veri cekiniz.
//Bunun icin class olusturmaliyiz. AnimalRestCallout adinda class acalim
//-------------class ici

public class AnimalRestCallout {
	
    public static void getAnimals(){
        //Postman'de 1-New'e bas 2- Http Request 3- Endpoint linki(URL) 4-Methodu sec(GET) 5-Send'e bas.
        Http http = new Http(); //1-
        HttpRequest request = new HttpRequest(); //2
        request.setEndpoint('https://th-apex-http-callout.herokuapp.com/animals'); //3
        request.setMethod('GET'); //4-GET buyuk harfle yazilmalidir
        HttpResponse response = http.send(request); //5-send'e basilinca gelen cevap response'a yuklendi
        
        if(response.getStatusCode()==200){ // esitse data sikintisiz gelmistir
            
            //Gelen data'yi ayristirma (parse) 'da iki yontem vardir.
            //1.yol: Parse islemi request'i yapan class icinde yapilir.
            //response.getBody() Json string yapisindadir.         
            
            //Map<String,Object> results = (Map<String,Object>) JSON.deserializeUntyped(response.getBody());
            //(Map<String,Object>) casting(kaliba dokmek) islemidir
            
            //List<Object> animals = (List<Object>) results.get('animals'); // get('animals')'taki animlas key'dir.
            //----------------------------------------------------
            //2.yol'da parse islemi icin ayri bir class olusturulur
            //Diger class'imizdan bir instance olusturacagiz.
            RestAnimalParse rap = RestAnimalParse.parse(response.getBody());
            
            for(Object w : rap.animals){
                System.debug(w);
                
            }             
        }
    }
}
//-------------2.yol'da kullandigimiz yardimci class ici
//
// Generated by JSON2Apex http://json2apex.herokuapp.com/
//

public class RestAnimalParse {

	public List<String> animals;

	
	public static RestAnimalParse parse(String json) {
		return (RestAnimalParse) System.JSON.deserialize(json, RestAnimalParse.class);
	}
}
//-------------calistirlmasi
AnimalRestCallout.getAnimals();
